!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).KGauge={})}(this,function(t){"use strict";var e=0;function n(t,e,n,i,a){var o=(new Date).getTime(),r=!0,s=e-t,l=function(){var e=(new Date).getTime()-o,u=Math.min(e/n,1),h=u;a&&(h=a(u)),i(t+h*s),u<1&&r&&window.requestAnimationFrame(l)};return window.requestAnimationFrame(l),function(){r=!1}}var i=function(t,e,n,i,a,o,r,s,l,u){"boolean"!=typeof r&&(l=s,s=r,r=!1);var h,d="function"==typeof n?n.options:n;if(t&&t.render&&(d.render=t.render,d.staticRenderFns=t.staticRenderFns,d._compiled=!0,a&&(d.functional=!0)),i&&(d._scopeId=i),o?(h=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),e&&e.call(this,l(t)),t&&t._registeredComponents&&t._registeredComponents.add(o)},d._ssrRegister=h):e&&(h=r?function(){e.call(this,u(this.$root.$options.shadowRoot))}:function(t){e.call(this,s(t))}),h)if(d.functional){var f=d.render;d.render=function(t,e){return h.call(e),f(t,e)}}else{var m=d.beforeCreate;d.beforeCreate=m?[].concat(m,h):[h]}return n},a={name:"k-gauge",props:{title:{type:String},titleStyle:{type:String,default:"fill: #999999; font-size: 20px; font-weight: bold"},width:{type:[Number,String],default:200},height:{type:[Number,String],default:150},value:{default:10},min:{type:Number,default:0},max:{type:Number,default:100},animationDuration:{type:Number,default:1e3},doughnut:{type:Boolean},formatFunction:{type:Function,default:Math.round},colorSteps:{type:Array,default:function(){return["#a9d70b","#f9c802","#ff0000"]}},valueFontStyle:{type:String,default:'font-size: 35px; fill: #010101; font-weight: bold; font-family: "Arial"'},labelFontStyle:{type:String,default:"font: 16px Arial; fill: #b3b3b3"},minMaxFontStyle:{type:String,default:"font: 16px Arial; fill: #b4b4b4"},animateOnLoad:{type:Boolean,default:!0},labelText:{type:String,default:""},showMinMax:{type:Boolean,default:!0},gaugeSize:{type:Number,default:1},shadowOpacity:{type:Number,default:.2},backgroundColor:{type:String,default:"#edebeb"},easingFunction:{type:Function,default:function(t){return t*(2-t)}}},data:function(){var t=this.colorSteps.map(function(t){for(var e=[],n=1;n<t.length;n+=2)e.push(parseInt("0x"+t.substr(n,2)));return e});return{shownValue:this.animateOnLoad?this.min:this.value,printValue:this.animateOnLoad?this.min:this.formatFunction(this.value),backgroundPath:"",gaugeColor:"",builtColorSteps:t,animationCanceler:null,renderId:"k-gauge-filter-"+ ++e,minTextX:0,maxTextX:0}},mounted:function(){this.$watch(function(t){return[t.height,t.width,t.doughnut,t.gaugeSize]},this.resetBgArc),this.resetBgArc()},methods:{makeArc:function(t){var e=this.gaugeSize,n=this.doughnut?220:250,i=this.doughnut?250:150;if(this.doughnut){var a=(1-2*(t-this.min)/(this.max-this.min))*Math.PI,o=.5*n-n/20,r=o-n/6.666666666666667*e,s=.5*n+0,l=.5*i+0,u=s+o*Math.cos(a),h=l-o*Math.sin(a),d=s+r*Math.cos(a),f=l-r*Math.sin(a),m="M"+(s-r)+","+l+" ";return m+="L"+(s-o)+","+l+" ",t>(this.max-this.min)/2&&(m+="A"+o+","+o+" 0 0 1 "+(s+o)+","+l+" "),m+="A"+o+","+o+" 0 0 1 "+u+","+h+" ",m+="L"+d+","+f+" ",t>(this.max-this.min)/2&&(m+="A"+r+","+r+" 0 0 0 "+(s+r)+","+l+" "),{path:m+="A"+r+","+r+" 0 0 0 "+(s-r)+","+l+" ",minTextX:60,maxTextX:190}}var c=(1-(t-this.min)/(this.max-this.min))*Math.PI,p=n/2-n/10,x=p-n/6.666666666666667*e,g=n/2+0,y=i/1.5+0,v=g+p*Math.cos(c),_=y-p*Math.sin(c),b=g+x*Math.cos(c),S=g-p,w=g-x,M="M"+w+","+y+" ";return M+="L"+S+","+y+" ",M+="A"+p+","+p+" 0 0 1 "+v+","+_+" ",M+="L"+b+","+(y-x*Math.sin(c))+" ",M+="A"+x+","+x+" 0 0 0 "+w+","+y+" ",{path:M+="Z ",minTextX:S+.5*(w-S),maxTextX:b+.5*(v-b)}},resetBgArc:function(){var t=this.makeArc(this.max);this.backgroundPath=t.path,this.minTextX=t.minTextX,this.maxTextX=t.maxTextX},getColorForValue:function(t){var e=this,n=this.builtColorSteps.length;if(t===this.max)return this.builtColorSteps[n-1];var i=t/this.max*(n-1),a=Math.floor(i),o=i%1;return this.builtColorSteps[a].map(function(t,n){return t+(e.builtColorSteps[a+1][n]-t)*o})},checkLimits:function(t){return Math.max(this.min,Math.min(this.max,t))}},computed:{gaugePath:function(){return this.makeArc(this.shownValue)},strokeStyle:function(){return this.doughnut?"transform: rotate(90deg); transform-origin: 125px 125px":""}},watch:{value:{handler:function(t){var e=this;this.animationCanceler&&this.animationCanceler(),this.animationCanceler=n(this.shownValue,this.checkLimits(t),this.animationDuration,function(t){e.shownValue=e.checkLimits(t),e.printValue=e.formatFunction(e.shownValue)},this.easingFunction)},immediate:!0},shownValue:{handler:function(t){var e=this.getColorForValue(t).join(",");this.gaugeColor="rgb("+e+")"},immediate:!0}}},o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("svg",{attrs:{height:t.height,version:"1.1",width:t.width,viewBox:"0 0 250 "+(t.doughnut?280:150),xmlns:"http://www.w3.org/2000/svg"}},[t.shadowOpacity?n("filter",{attrs:{id:t.renderId}},[n("feOffset",{attrs:{dx:"0",dy:"3"}}),t._v(" "),n("feGaussianBlur",{attrs:{result:"offset-blur",stdDeviation:"5"}}),t._v(" "),n("feComposite",{attrs:{operator:"out",in:"SourceGraphic",in2:"offset-blur",result:"inverse"}}),t._v(" "),n("feFlood",{attrs:{"flood-color":"black","flood-opacity":t.shadowOpacity,result:"color"}}),t._v(" "),n("feComposite",{attrs:{operator:"in",in:"color",in2:"inverse",result:"shadow"}}),t._v(" "),n("feComposite",{attrs:{operator:"over",in:"shadow",in2:"SourceGraphic"}})],1):t._e(),t._v(" "),t.title?n("text",{style:t.titleStyle,attrs:{y:"15",x:"125","text-anchor":"middle"}},[n("tspan",{domProps:{innerHTML:t._s(t.title)}})]):t._e(),t._v(" "),n("g",{attrs:{transform:"translate(0 20)"}},[n("path",{style:t.strokeStyle,attrs:{fill:t.backgroundColor,stroke:"none",d:t.backgroundPath,filter:"url(#"+t.renderId+")"}}),t._v(" "),n("path",{style:t.strokeStyle,attrs:{fill:t.gaugeColor,stroke:"none",d:t.gaugePath.path,filter:"url(#"+t.renderId+")"}}),t._v(" "),n("text",{style:t.valueFontStyle,attrs:{x:"125",y:t.doughnut?118:100,"text-anchor":"middle"}},[n("tspan",{domProps:{innerHTML:t._s(t.printValue)}})]),t._v(" "),n("text",{style:t.labelFontStyle,attrs:{x:"125",y:t.doughnut?142:120,"text-anchor":"middle"},domProps:{innerHTML:t._s(t.labelText)}},[n("tspan",{domProps:{innerHTML:t._s(t.labelText)}})]),t._v(" "),t.showMinMax&&!t.doughnut?n("text",{style:t.minMaxFontStyle,attrs:{x:t.minTextX,y:120,"text-anchor":"middle"}},[n("tspan",{domProps:{innerHTML:t._s(t.min)}})]):t._e(),t._v(" "),t.showMinMax&&!t.doughnut?n("text",{style:t.minMaxFontStyle,attrs:{x:t.maxTextX,y:120,"text-anchor":"middle"}},[n("tspan",{domProps:{innerHTML:t._s(t.max)}})]):t._e(),t._v(" "),t.showMinMax&&t.doughnut?n("text",{style:t.minMaxFontStyle,attrs:{x:125,y:240,"text-anchor":"middle"}},[n("tspan",[t._v(t._s(t.max)+" "+t._s(t.labelText))])]):t._e()])])};o._withStripped=!0;var r=i({render:o,staticRenderFns:[]},void 0,a,void 0,!1,void 0,void 0,void 0);t.animateCalc=n,t.default=r,Object.defineProperty(t,"__esModule",{value:!0})});
