let t=0;function e(t,e,i,n,a){const o=(new Date).getTime();let r=!0;const s=e-t,h=()=>{const e=(new Date).getTime()-o;let l=Math.min(e/i,1),u=l;a&&(u=a(l)),n(t+u*s),l<1&&r&&window.requestAnimationFrame(h)};return window.requestAnimationFrame(h),function(){r=!1}}var i=function(t,e,i,n,a,o,r,s,h,l){"boolean"!=typeof r&&(h=s,s=r,r=!1);var u,d="function"==typeof i?i.options:i;if(t&&t.render&&(d.render=t.render,d.staticRenderFns=t.staticRenderFns,d._compiled=!0,a&&(d.functional=!0)),n&&(d._scopeId=n),o?(u=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),e&&e.call(this,h(t)),t&&t._registeredComponents&&t._registeredComponents.add(o)},d._ssrRegister=u):e&&(u=r?function(){e.call(this,l(this.$root.$options.shadowRoot))}:function(t){e.call(this,s(t))}),u)if(d.functional){var m=d.render;d.render=function(t,e){return u.call(e),m(t,e)}}else{var c=d.beforeCreate;d.beforeCreate=c?[].concat(c,u):[u]}return i};const n={name:"k-gauge",props:{title:{type:String},titleStyle:{type:String,default:"fill: #999999; font-size: 20px; font-weight: bold"},width:{type:[Number,String],default:200},height:{type:[Number,String],default:150},value:{default:10},min:{type:Number,default:0},max:{type:Number,default:100},animationDuration:{type:Number,default:1e3},doughnut:{type:Boolean},formatFunction:{type:Function,default:Math.round},colorSteps:{type:Array,default:()=>["#a9d70b","#f9c802","#ff0000"]},valueFontStyle:{type:String,default:'font-size: 35px; fill: #010101; font-weight: bold; font-family: "Arial"'},labelFontStyle:{type:String,default:"font: 16px Arial; fill: #b3b3b3"},minMaxFontStyle:{type:String,default:"font: 16px Arial; fill: #b4b4b4"},animateOnLoad:{type:Boolean,default:!0},labelText:{type:String,default:""},showMinMax:{type:Boolean,default:!0},gaugeSize:{type:Number,default:1},shadowOpacity:{type:Number,default:.2},backgroundColor:{type:String,default:"#edebeb"},easingFunction:{type:Function,default:t=>t*(2-t)},maxTextFormatFn:{type:Function,default:t=>t},minTextFormatFn:{type:Function,default:t=>t}},data(){const e=this.colorSteps.map(t=>{const e=[];for(let i=1;i<t.length;i+=2)e.push(parseInt(`0x${t.substr(i,2)}`));return e});return{shownValue:this.animateOnLoad?this.min:this.value,printValue:this.animateOnLoad?this.min:this.formatFunction(this.value),backgroundPath:"",gaugeColor:"",builtColorSteps:e,animationCanceler:null,renderId:`k-gauge-filter-${++t}`,minTextX:0,maxTextX:0}},mounted(){if(this.min===this.max)throw Error("Min and max can not be equal");this.$watch(t=>[t.height,t.width,t.doughnut,t.gaugeSize],this.resetBgArc),this.resetBgArc()},methods:{reverseValue(t){const e=this.max-this.min,i=(t-this.min)/e;return this.max-e*i},makeArc(t){const e=this.gaugeSize,i=this.doughnut?220:250,n=this.doughnut?250:150;if(this.doughnut){let a,o;this.isReversed?(t=this.reverseValue(t),o=this.min-this.max,a=t-this.max):(o=this.max-this.min,a=t-this.min);const r=(1-2*a/o)*Math.PI,s=.5*i-i/20,h=s-i/6.666666666666667*e,l=.5*i+0,u=.5*n+0,d=l+s*Math.cos(r),m=u-s*Math.sin(r),c=l+h*Math.cos(r),p=u-h*Math.sin(r);let f="M"+(l-h)+","+u+" ";return f+="L"+(l-s)+","+u+" ",a>.5*o&&(f+="A"+s+","+s+" 0 0 1 "+(l+s)+","+u+" "),f+="A"+s+","+s+" 0 0 1 "+d+","+m+" ",f+="L"+c+","+p+" ",a>.5*o&&(f+="A"+h+","+h+" 0 0 0 "+(l+h)+","+u+" "),{path:f+="A"+h+","+h+" 0 0 0 "+(l-h)+","+u+" ",minTextX:60,maxTextX:190}}const a=(1-(t-this.min)/(this.max-this.min))*Math.PI,o=i/2-i/10,r=o-i/6.666666666666667*e,s=i/2+0,h=n/1.5+0,l=s+o*Math.cos(a),u=h-o*Math.sin(a),d=s+r*Math.cos(a),m=s-o,c=s-r;let p="M"+c+","+h+" ";return p+="L"+m+","+h+" ",p+="A"+o+","+o+" 0 0 1 "+l+","+u+" ",p+="L"+d+","+(h-r*Math.sin(a))+" ",p+="A"+r+","+r+" 0 0 0 "+c+","+h+" ",{path:p+="Z ",minTextX:m+.5*(c-m),maxTextX:d+.5*(l-d)}},resetBgArc(){const t=this.makeArc(this.max);this.backgroundPath=t.path,this.minTextX=t.minTextX,this.maxTextX=t.maxTextX},getColorForValue(t){const e=this.builtColorSteps.length;if(t===this.max)return this.builtColorSteps[e-1];if(1===e)return this.builtColorSteps[0];const i=(t-this.min)/(this.max-this.min)*(e-1),n=Math.floor(i),a=i%1;return this.builtColorSteps[n].map((t,e)=>{const i=this.builtColorSteps[n+1][e]-t;return Math.round(t+i*a)})},checkLimits(t){return Math.max(this.isReversed?this.max:this.min,Math.min(this.isReversed?this.min:this.max,t))}},computed:{gaugePath(){return this.makeArc(this.shownValue)},strokeStyle(){return this.doughnut?"transform: rotate(90deg); transform-origin: 125px 125px":""},isReversed(){return this.min>this.max},pathArgs(){const t={stroke:"none",style:this.strokeStyle};return this.shadowOpacity&&(t.filter=`url(#${this.renderId})`),t}},watch:{value:{handler(t){this.animationCanceler&&this.animationCanceler(),this.animationCanceler=e(this.shownValue,this.checkLimits(t),this.animationDuration,t=>{this.shownValue=this.checkLimits(t),this.printValue=this.formatFunction(this.shownValue)},this.easingFunction)},immediate:!0},shownValue:{handler(t){let e=this.getColorForValue(t).join(",");this.gaugeColor=`rgb(${e})`},immediate:!0}}};var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("svg",{attrs:{height:t.height,version:"1.1",width:t.width,viewBox:"0 0 250 "+(t.doughnut?280:150),xmlns:"http://www.w3.org/2000/svg"}},[t.shadowOpacity?i("filter",{attrs:{id:t.renderId}},[i("feOffset",{attrs:{dx:"0",dy:"3"}}),t._v(" "),i("feGaussianBlur",{attrs:{result:"offset-blur",stdDeviation:"5"}}),t._v(" "),i("feComposite",{attrs:{operator:"out",in:"SourceGraphic",in2:"offset-blur",result:"inverse"}}),t._v(" "),i("feFlood",{attrs:{"flood-color":"black","flood-opacity":t.shadowOpacity,result:"color"}}),t._v(" "),i("feComposite",{attrs:{operator:"in",in:"color",in2:"inverse",result:"shadow"}}),t._v(" "),i("feComposite",{attrs:{operator:"over",in:"shadow",in2:"SourceGraphic"}})],1):t._e(),t._v(" "),t.title?i("text",{style:t.titleStyle,attrs:{y:"15",x:"125","text-anchor":"middle"}},[i("tspan",{domProps:{innerHTML:t._s(t.title)}})]):t._e(),t._v(" "),i("g",{attrs:{transform:"translate(0 20)"}},[i("path",t._b({attrs:{fill:t.backgroundColor,d:t.backgroundPath}},"path",t.pathArgs,!1)),t._v(" "),i("path",t._b({attrs:{fill:t.gaugeColor,d:t.gaugePath.path}},"path",t.pathArgs,!1)),t._v(" "),i("text",{style:t.valueFontStyle,attrs:{x:"125",y:t.doughnut?118:100,"text-anchor":"middle"}},[i("tspan",{domProps:{innerHTML:t._s(t.printValue)}})]),t._v(" "),i("text",{style:t.labelFontStyle,attrs:{x:"125",y:t.doughnut?142:120,"text-anchor":"middle"},domProps:{innerHTML:t._s(t.labelText)}},[i("tspan",{domProps:{innerHTML:t._s(t.labelText)}})]),t._v(" "),t.showMinMax&&!t.doughnut?i("text",{style:t.minMaxFontStyle,attrs:{x:t.minTextX,y:120,"text-anchor":"middle"}},[i("tspan",{domProps:{innerHTML:t._s(t.minTextFormatFn(t.min))}})]):t._e(),t._v(" "),t.showMinMax&&!t.doughnut?i("text",{style:t.minMaxFontStyle,attrs:{x:t.maxTextX,y:120,"text-anchor":"middle"}},[i("tspan",{domProps:{innerHTML:t._s(t.maxTextFormatFn(t.max))}})]):t._e(),t._v(" "),t.showMinMax&&t.doughnut?i("text",{style:t.minMaxFontStyle,attrs:{x:125,y:240,"text-anchor":"middle"}},[i("tspan",[t._v(t._s(t.max)+" "+t._s(t.labelText))])]):t._e()])])};a._withStripped=!0;export default i({render:a,staticRenderFns:[]},void 0,n,void 0,!1,void 0,void 0,void 0);export{e as animateCalc};
