!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).KGuage={})}(this,function(t){"use strict";var e=0;function n(t,e,n,i,a){var o=(new Date).getTime(),r=!0,s=e-t,u=function(){var e=(new Date).getTime()-o,l=Math.min(e/n,1),h=l;a&&(h=a(l)),i(t+h*s),l<1&&r&&window.requestAnimationFrame(u)};return window.requestAnimationFrame(u),function(){r=!1}}var i=function(t,e,n,i,a,o,r,s,u,l){"boolean"!=typeof r&&(u=s,s=r,r=!1);var h,d="function"==typeof n?n.options:n;if(t&&t.render&&(d.render=t.render,d.staticRenderFns=t.staticRenderFns,d._compiled=!0,a&&(d.functional=!0)),i&&(d._scopeId=i),o?(h=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),e&&e.call(this,u(t)),t&&t._registeredComponents&&t._registeredComponents.add(o)},d._ssrRegister=h):e&&(h=r?function(){e.call(this,l(this.$root.$options.shadowRoot))}:function(t){e.call(this,s(t))}),h)if(d.functional){var f=d.render;d.render=function(t,e){return h.call(e),f(t,e)}}else{var m=d.beforeCreate;d.beforeCreate=m?[].concat(m,h):[h]}return n},a={name:"k-guage",props:{title:{type:String},width:{type:Number,default:200},height:{type:Number,default:150},value:{default:10},min:{type:Number,default:0},max:{type:Number,default:100},animationDuration:{type:Number,default:1e3},doughnut:{type:Boolean},formatFunction:{type:Function,default:Math.round},colorSteps:{type:Array,default:function(){return["#a9d70b","#f9c802","#ff0000"]}},valueFontStyle:{type:String,default:'font-size: 35px; fill: #010101; font-weight: bold; font-family: "Arial"'},labelFontStyle:{type:String,default:"font: 10px Arial; fill: #b3b3b3"},minMaxFontStyle:{type:String,default:"font: 10px Arial; fill: #b4b4b4"},animateOnLoad:{type:Boolean,default:!0},labelText:{type:String,default:""},showMinMax:{type:Boolean,default:!0},guageSize:{type:Number,default:1},shadowOpacity:{type:Number,default:.2},backgroundColor:{type:String,default:"#edebeb"},easingFunction:{type:Function,default:function(t){return t*(2-t)}}},data:function(){var t=this.colorSteps.map(function(t){for(var e=[],n=1;n<t.length;n+=2)e.push(parseInt("0x"+t.substr(n,2)));return e});return{shownValue:this.animateOnLoad?this.min:this.value,printValue:this.animateOnLoad?this.min:this.formatFunction(this.value),backgroundPath:"",guageColor:"",builtColorSteps:t,animationCanceler:null,renderId:"k-guage-filter-"+ ++e,minTextX:0,maxTextX:0}},mounted:function(){this.$watch(function(t){return[t.height,t.width,t.doughnut,t.guageSize]},this.resetBgArc),this.resetBgArc()},methods:{makeArc:function(t){var e=this.guageSize,n=this.doughnut?250:150;if(this.doughnut){var i=(1-2*(t-this.min)/(this.max-this.min))*Math.PI,a=112.5-37.5*e,o=.5*n+0,r=125+112.5*Math.cos(i),s=o-112.5*Math.sin(i),u=125+a*Math.cos(i),l=o-a*Math.sin(i),h="M"+(125-a)+","+o+" ";return h+="L12.5,"+o+" ",t>(this.max-this.min)/2&&(h+="A112.5,112.5 0 0 1 237.5,"+o+" "),h+="A112.5,112.5 0 0 1 "+r+","+s+" ",h+="L"+u+","+l+" ",t>(this.max-this.min)/2&&(h+="A"+a+","+a+" 0 0 0 "+(125+a)+","+o+" "),{path:h+="A"+a+","+a+" 0 0 0 "+(125-a)+","+o+" ",minTextX:60,maxTextX:190}}var d=(1-(t-this.min)/(this.max-this.min))*Math.PI,f=100-37.5*e,m=n/1.5+0,c=125+100*Math.cos(d),p=m-100*Math.sin(d),g=125+f*Math.cos(d),x=125-f,v="M"+x+","+m+" ";return v+="L25,"+m+" ",v+="A100,100 0 0 1 "+c+","+p+" ",v+="L"+g+","+(m-f*Math.sin(d))+" ",v+="A"+f+","+f+" 0 0 0 "+x+","+m+" ",{path:v+="Z ",minTextX:25+.5*(x-25),maxTextX:g+.5*(c-g)}},resetBgArc:function(){var t=this.makeArc(this.max);this.backgroundPath=t.path,this.minTextX=t.minTextX,this.maxTextX=t.maxTextX},getColorForValue:function(t){var e=this,n=this.builtColorSteps.length;if(t===this.max)return this.builtColorSteps[n-1];var i=t/this.max*(n-1),a=Math.floor(i),o=i%1;return this.builtColorSteps[a].map(function(t,n){return t+(e.builtColorSteps[a+1][n]-t)*o})},checkLimits:function(t){return Math.max(this.min,Math.min(this.max,t))}},computed:{guagePath:function(){return this.makeArc(this.shownValue)},strokeStyle:function(){return this.doughnut?"transform: rotate(90deg); transform-origin: 50% 50%":""}},watch:{value:{handler:function(t){var e=this;this.animationCanceler&&this.animationCanceler(),this.animationCanceler=n(this.shownValue,this.checkLimits(t),this.animationDuration,function(t){e.shownValue=e.checkLimits(t),e.printValue=e.formatFunction(e.shownValue)},this.easingFunction)},immediate:!0},shownValue:{handler:function(t){var e=this.getColorForValue(t).join(",");this.guageColor="rgb("+e+")"},immediate:!0}}},o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("svg",{attrs:{height:t.height,version:"1.1",width:t.width,viewBox:"0 0 250 "+(t.doughnut?250:150),xmlns:"http://www.w3.org/2000/svg"}},[t.shadowOpacity?n("filter",{attrs:{id:t.renderId}},[n("feOffset",{attrs:{dx:"0",dy:"3"}}),t._v(" "),n("feGaussianBlur",{attrs:{result:"offset-blur",stdDeviation:"5"}}),t._v(" "),n("feComposite",{attrs:{operator:"out",in:"SourceGraphic",in2:"offset-blur",result:"inverse"}}),t._v(" "),n("feFlood",{attrs:{"flood-color":"black","flood-opacity":t.shadowOpacity,result:"color"}}),t._v(" "),n("feComposite",{attrs:{operator:"in",in:"color",in2:"inverse",result:"shadow"}}),t._v(" "),n("feComposite",{attrs:{operator:"over",in:"shadow",in2:"SourceGraphic"}})],1):t._e(),t._v(" "),t.title?n("text",{staticStyle:{fill:"#999999","font-size":"16px","font-weight":"bold"},attrs:{y:"16",x:"125","text-anchor":"middle"}},[n("tspan",{domProps:{innerHTML:t._s(t.title)}})]):t._e(),t._v(" "),n("g",{attrs:{transform:t.doughnut?"translate(0 10)":"translate(0 33)"}},[n("path",{style:t.strokeStyle,attrs:{fill:t.backgroundColor,stroke:"none",d:t.backgroundPath,filter:"url(#"+t.renderId+")"}}),t._v(" "),n("path",{style:t.strokeStyle,attrs:{fill:t.guageColor,stroke:"none",d:t.guagePath.path,filter:"url(#"+t.renderId+")"}}),t._v(" "),n("text",{style:t.valueFontStyle,attrs:{x:"125",y:t.doughnut?128:100,"text-anchor":"middle"}},[n("tspan",{domProps:{innerHTML:t._s(t.printValue)}})]),t._v(" "),n("text",{style:t.labelFontStyle,attrs:{x:"125",y:t.doughnut?140:112,"text-anchor":"middle"},domProps:{innerHTML:t._s(t.labelText)}},[n("tspan",{domProps:{innerHTML:t._s(t.labelText)}})]),t._v(" "),t.showMinMax?n("text",{style:t.minMaxFontStyle,attrs:{x:t.minTextX,y:t.doughnut?133:116,"text-anchor":"middle"}},[n("tspan",{domProps:{innerHTML:t._s(t.min)}})]):t._e(),t._v(" "),t.showMinMax?n("text",{style:t.minMaxFontStyle,attrs:{x:t.maxTextX,y:t.doughnut?133:116,"text-anchor":"middle"},domProps:{innerHTML:t._s(t.max)}},[n("tspan",{domProps:{innerHTML:t._s(t.max)}})]):t._e()])])};o._withStripped=!0;var r=i({render:o,staticRenderFns:[]},void 0,a,void 0,!1,void 0,void 0,void 0);t.animateCalc=n,t.default=r,Object.defineProperty(t,"__esModule",{value:!0})});
